[{"title":"IFEST 2025 CTF Writeup","url":"/2025/05/27/IFEST-2025-CTF-Writeup/","content":"Web ExploitationWeb v2User(**data) disini vulnerable, user bisa kasih parameter is_admin=1 dan bisa keregister sebagai admin.\n\nBerhasil register dengan role admin.\n\nSelanjutnya kita pengen ke /admin/fetch untuk melakukan SSRF, akan tetapi terdapat proteksi pada nginxnya. Ketika kita ke situ bakalan langsung di block.\n\nSesuai dengan source yang saya dapatkan (https://blog.1nf1n1ty.team/hacktricks/pentesting-web/proxy-waf-protections-bypass), konfigurasi itu vulnerable dimana attacker bisa ngebypass rules tersebut dengan menambahkan special character pada requestnya.\nKarena nginx server menggunakan version 1.22.0, dan backendnya adalah Flask, maka karakter special itu adalah \\x85 atau \\xA0.\n\nTinggal bikin request di burpsuite, dan tambahkan \\x85 setelah /admin/fetch\n\nBerhasil ngebypass rules nginx.\n\nPada saat ingin melakukan ssrf ke /internal, terdapat proteksi dimana url yang kita berikan akan diparse menggunakan urlparse, dan akan dicek hostnamenya.\n\nKita dapat membypass proteksi itu dengan memberi \\@daffainfo.com, dimana urlparse akan menganggap hostnamenya adalah daffainfo.com.\n\nSetelah itu akan digunakan requests.get, dimana requests.get akan menganggap \\@daffainfo.com sebagai url path.\n\nSehingga kita pake path traversal saja untuk menghilangkan /%5C@daffainfo.com itu\n\nDan berhasil solp ðŸ˜€\n\nPixelPlaza2Function staticHandler berikut vulnerable terhadap path traversal\n\nKenapa bisa path traversal? Normalnya url itu dinormalize, tetapi jika HTTP methodnya adalah CONNECT, go ini tidak ngenormalize urlnya.\nhttps://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/golang.html?highlight=path%20traversal%20proc#connect-method\nDengan command\ncurl &quot;http://103.163.139.198:8888/../../../etc/shadow&quot; -X CONNECT --path-as-is\n\nkita berhasil melihat isi &#x2F;etc&#x2F;shadow file.\n\nAwalnya saya mencari-cari default files, config files, &#x2F;proc&#x2F;self&#x2F;environ untuk mencari jalan menuju fleg, akan tetapi tidak membuahkan hasil.\nPada saat saya mengunjungi /about.html, terdapat url menuju /docs/text, Nah filenya itu ga ada\n\nNah ternyata directory docs itu ada di directory sebelumnya.\nSehingga dapet deh flagnya\ncurl &quot;http://103.163.139.198:8888/../docs/text&quot; -X CONNECT --path-as-is\n\n\n"}]